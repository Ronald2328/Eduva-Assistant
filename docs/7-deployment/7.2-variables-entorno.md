# 7.2 Variables de Entorno

## Lista Completa de Variables

### Aplicación

```bash
APP_NAME=ScienceBot WhatsApp API
APP_VERSION=1.0.0
ENVIRONMENT=production  # development | staging | production
```

---

### Evolution API

```bash
EVOLUTION_API_URL=https://evolution-api-production-be18.up.railway.app
EVOLUTION_API_KEY=your_secret_api_key
```

**¿Dónde obtener?**:
- `EVOLUTION_API_URL`: URL pública del servicio Evolution en Railway
- `EVOLUTION_API_KEY`: Configurada en Evolution API settings

---

### OpenAI

```bash
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxx
OPENAI_MODEL=gpt-4o-mini
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_MAX_TOKENS=1000
OPENAI_TEMPERATURE=0
```

**¿Dónde obtener?**:
- `OPENAI_API_KEY`: [platform.openai.com/api-keys](https://platform.openai.com/api-keys)

---

### MongoDB Atlas

```bash
MONGO_URL=mongodb+srv://user:password@cluster.mongodb.net
MONGO_DATABASE=ScienceBot
MONGO_DOCUMENTS_COLLECTION=Documents
MONGO_PAGES_COLLECTION=ScienceBot
```

**¿Dónde obtener?**:
- `MONGO_URL`: MongoDB Atlas Dashboard → Connect → Connection String

---

### Monitoreo (Opcional)

```bash
LOGFIRE_TOKEN=your_logfire_token
```

**¿Dónde obtener?**:
- [logfire.pydantic.dev](https://logfire.pydantic.dev)

---

## Seguridad y Secretos

### ✅ Buenas Prácticas

1. **Nunca commitear secrets al repo**:
   ```bash
   # .gitignore
   .env
   .env.local
   ```

2. **Usar Railway Variables**:
   - Service Settings → Variables → Add Variable

3. **Rotar API Keys periódicamente**:
   - OpenAI: Cada 3-6 meses
   - Evolution API: Cada 6 meses

4. **Variables sensibles como SECRET**:
   - Railway marca como "secret" (no visible en logs)

---

### ❌ Evitar

```python
# ❌ NO hardcodear secrets
OPENAI_API_KEY = "sk-proj-12345..."

# ✅ Usar variables de entorno
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
```

---

## Configuración en Railway

```bash
# Railway Dashboard
Service → Variables

# Agregar variables una por una
OPENAI_API_KEY=sk-proj-xxxxx (secret) ✅
MONGO_URL=mongodb+srv://... (secret) ✅
ENVIRONMENT=production ✅
```

**Railway automáticamente reinicia el servicio** al cambiar variables.

---

**Volver al índice**: [../README.md](../README.md)
